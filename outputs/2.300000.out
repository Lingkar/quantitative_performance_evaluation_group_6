2020-10-04 14:57:31 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2020-10-04 14:57:32 INFO  SparkContext:54 - Running Spark version 2.3.1
2020-10-04 14:57:32 INFO  SparkContext:54 - Submitted application: lenet5
2020-10-04 14:57:32 INFO  SecurityManager:54 - Changing view acls to: bartziengs
2020-10-04 14:57:32 INFO  SecurityManager:54 - Changing modify acls to: bartziengs
2020-10-04 14:57:32 INFO  SecurityManager:54 - Changing view acls groups to: 
2020-10-04 14:57:32 INFO  SecurityManager:54 - Changing modify acls groups to: 
2020-10-04 14:57:32 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(bartziengs); groups with view permissions: Set(); users  with modify permissions: Set(bartziengs); groups with modify permissions: Set()
2020-10-04 14:57:33 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 33061.
2020-10-04 14:57:33 INFO  SparkEnv:54 - Registering MapOutputTracker
2020-10-04 14:57:33 INFO  SparkEnv:54 - Registering BlockManagerMaster
2020-10-04 14:57:33 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2020-10-04 14:57:33 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2020-10-04 14:57:33 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-404fb77d-90b7-44cd-bab0-78d7e8d9fafd
2020-10-04 14:57:33 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2020-10-04 14:57:33 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2020-10-04 14:57:33 INFO  log:192 - Logging initialized @3021ms
2020-10-04 14:57:33 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2020-10-04 14:57:33 INFO  Server:414 - Started @3160ms
2020-10-04 14:57:33 INFO  AbstractConnector:278 - Started ServerConnector@684075c0{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2020-10-04 14:57:33 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6ca9fcb6{/jobs,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7bd2d451{/jobs/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@428a266d{/jobs/job,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@243e954{/jobs/job/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6fded511{/stages,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7cf42fc9{/stages/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@434590b0{/stages/stage,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1ae91d1a{/stages/stage/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@75c6dee7{/stages/pool,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2581a77a{/stages/pool/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@15cdbfe9{/storage,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@471e6187{/storage/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@46cbe65{/storage/rdd,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2c7e73e5{/storage/rdd/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@54b4a374{/environment,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6012e23c{/environment/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1ecf7cd{/executors,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5e525d4e{/executors/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2f0ceaf3{/executors/threadDump,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5878ee2c{/executors/threadDump/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3ecc2871{/static,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@723a1d9c{/,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@39f0d01f{/api,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2ab1825a{/jobs/job/kill,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5565f9a2{/stages/stage/kill,null,AVAILABLE,@Spark}
2020-10-04 14:57:33 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:4040
2020-10-04 14:57:33 INFO  SparkContext:54 - Added JAR file:///home/am72ghiassi/bd/spark/lib/bigdl-SPARK_2.3-0.11.0-jar-with-dependencies.jar at spark://bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:33061/jars/bigdl-SPARK_2.3-0.11.0-jar-with-dependencies.jar with timestamp 1601823453864
2020-10-04 14:57:33 INFO  SparkContext:54 - Added file file:/home/am72ghiassi/bd/codes/lenet5.py at spark://bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:33061/files/lenet5.py with timestamp 1601823453915
2020-10-04 14:57:33 INFO  Utils:54 - Copying /home/am72ghiassi/bd/codes/lenet5.py to /tmp/spark-9879c923-aea5-4e5c-a85b-7b34abf0d015/userFiles-ccfaffe0-a207-4999-88b6-621f95fd79ea/lenet5.py
2020-10-04 14:57:33 INFO  SparkContext:54 - Added file file:///home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip at spark://bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:33061/files/bigdl-0.11.0-python-api.zip with timestamp 1601823453926
2020-10-04 14:57:33 INFO  Utils:54 - Copying /home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip to /tmp/spark-9879c923-aea5-4e5c-a85b-7b34abf0d015/userFiles-ccfaffe0-a207-4999-88b6-621f95fd79ea/bigdl-0.11.0-python-api.zip
2020-10-04 14:57:34 INFO  StandaloneAppClient$ClientEndpoint:54 - Connecting to master spark://10.128.0.3:7077...
2020-10-04 14:57:34 INFO  TransportClientFactory:267 - Successfully created connection to /10.128.0.3:7077 after 50 ms (0 ms spent in bootstraps)
2020-10-04 14:57:34 INFO  StandaloneSchedulerBackend:54 - Connected to Spark cluster with app ID app-20201004145734-0004
2020-10-04 14:57:34 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor added: app-20201004145734-0004/0 on worker-20201004135436-10.128.0.5-45771 (10.128.0.5:45771) with 1 core(s)
2020-10-04 14:57:34 INFO  StandaloneSchedulerBackend:54 - Granted executor ID app-20201004145734-0004/0 on hostPort 10.128.0.5:45771 with 1 core(s), 1024.0 MB RAM
2020-10-04 14:57:34 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34841.
2020-10-04 14:57:34 INFO  NettyBlockTransferService:54 - Server created on bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:34841
2020-10-04 14:57:34 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2020-10-04 14:57:34 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor updated: app-20201004145734-0004/0 is now RUNNING
2020-10-04 14:57:34 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal, 34841, None)
2020-10-04 14:57:34 INFO  BlockManagerMasterEndpoint:54 - Registering block manager bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal:34841 with 366.3 MB RAM, BlockManagerId(driver, bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal, 34841, None)
2020-10-04 14:57:34 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal, 34841, None)
2020-10-04 14:57:34 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, bigdl-bart-group6.us-central1-a.c.my-project-1470235383272.internal, 34841, None)
2020-10-04 14:57:34 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1082ec8a{/metrics/json,null,AVAILABLE,@Spark}
2020-10-04 14:57:36 INFO  CoarseGrainedSchedulerBackend$DriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (10.128.0.5:51798) with ID 0
2020-10-04 14:57:36 INFO  StandaloneSchedulerBackend:54 - SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 1.0
2020-10-04 14:57:36 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.128.0.5:39613 with 366.3 MB RAM, BlockManagerId(0, 10.128.0.5, 39613, None)
2020-10-04 14:57:37 INFO  Engine$:121 - Auto detect executor number and executor cores number
2020-10-04 14:57:37 INFO  Engine$:123 - Executor number is 1 and executor cores number is 1
2020-10-04 14:57:39 INFO  ThreadPool$:95 - Set mkl threads to 1 on thread 17
2020-10-04 14:57:39 INFO  Engine$:446 - Find existing spark context. Checking the spark conf...
cls.getname: com.intel.analytics.bigdl.python.api.Sample
BigDLBasePickler registering: bigdl.util.common  Sample
cls.getname: com.intel.analytics.bigdl.python.api.EvaluatedResult
BigDLBasePickler registering: bigdl.util.common  EvaluatedResult
cls.getname: com.intel.analytics.bigdl.python.api.JTensor
BigDLBasePickler registering: bigdl.util.common  JTensor
cls.getname: com.intel.analytics.bigdl.python.api.JActivity
BigDLBasePickler registering: bigdl.util.common  JActivity
0.01
('Extracting', '/home/am72ghiassi/bd/quantitative_performance_evaluation_group_6/data/random_duplicates/train-images-idx3-ubyte.gz')
Traceback (most recent call last):
  File "/home/am72ghiassi/bd/codes/lenet5.py", line 64, in <module>
    (train_data, test_data) = preprocess_mnist(sc, options)
  File "/home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip/bigdl/models/lenet/utils.py", line 44, in preprocess_mnist
    
  File "/home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip/bigdl/models/lenet/utils.py", line 32, in get_mnist
    
  File "/home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip/bigdl/dataset/mnist.py", line 103, in read_data_sets
  File "/home/am72ghiassi/bd/spark/lib/bigdl-0.11.0-python-api.zip/bigdl/dataset/mnist.py", line 53, in extract_images
ValueError: Invalid magic number 2049 in MNIST image file: /home/am72ghiassi/bd/quantitative_performance_evaluation_group_6/data/random_duplicates/train-images-idx3-ubyte.gz
